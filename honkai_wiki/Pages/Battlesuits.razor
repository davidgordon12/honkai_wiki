@page "/battlesuits"
@using Newtonsoft.Json
@using honkai_wiki_api.Models
@using honkai_wiki.Services
@inject IBattlesuitService BattlesuitService

<style>
    #filters {
        display: flex;
        flex-direction: row;
        flex-wrap: wrap;
    }
    #filter_btn {
        display:contents;
    }
</style>

<h1 class="mt-3">Battlesuits</h1>
<h4 class="mt-3">Filter by Type:</h4>

<div id="filters">
    <button id="filter_btn" @onclick="FilterType"><Filter Icon="https://public-assets.abyss-lab.app/honkai3rd/type-icons/mecha.png" Type="Mech"></Filter></button>
    <button id="filter_btn" @onclick="FilterType"><Filter Icon="https://public-assets.abyss-lab.app/honkai3rd/type-icons/biologic.png" Type="Biologic"></Filter></button>
    <button id="filter_btn" @onclick="FilterType"><Filter Icon="https://public-assets.abyss-lab.app/honkai3rd/type-icons/psychic.png" Type="Pyschic"></Filter></button>
    <button id="filter_btn" @onclick="FilterType"><Filter Icon="https://public-assets.abyss-lab.app/honkai3rd/type-icons/imaginary.png" Type="Imaginary"></Filter></button>
    <button id="filter_btn" @onclick="FilterType"><Filter Icon="https://public-assets.abyss-lab.app/honkai3rd/type-icons/quantum.png" Type="Quantum"></Filter></button>
</div>

<h4 class="mt-3">Filter by Element:</h4>

<div id="filters">
    <button id="filter_btn" @onclick="FilterElement"><Filter Icon="https://public-assets.abyss-lab.app/honkai3rd/feature-icons/physical.png" Type="Physical"></Filter></button>
    <button id="filter_btn" @onclick="FilterElement"><Filter Icon="https://public-assets.abyss-lab.app/honkai3rd/feature-icons/fire-dmg.png" Type="Fire"></Filter></button>
    <button id="filter_btn" @onclick="FilterElement"><Filter Icon="https://public-assets.abyss-lab.app/honkai3rd/feature-icons/ice-dmg.png" Type="Ice"></Filter></button>
    <button id="filter_btn" @onclick="FilterElement"><Filter Icon="https://public-assets.abyss-lab.app/honkai3rd/feature-icons/lightning-dmg.png" Type="Lightning"></Filter></button>
</div>

<h4 class="mt-3">Filter by Rank:</h4>

<div id="filters">
    <button id="filter_btn" @onclick="FilterRank"><Filter Icon="https://public-assets.abyss-lab.app/honkai3rd/rank-icons/s-rank.png" Type="S Rank"></Filter></button>
    <button id="filter_btn" @onclick="FilterRank"><Filter Icon="https://public-assets.abyss-lab.app/honkai3rd/rank-icons/a-rank.png" Type="A Rank"></Filter></button>
    <button id="filter_btn" @onclick="FilterRank"><Filter Icon="https://public-assets.abyss-lab.app/honkai3rd/rank-icons/b-rank.png" Type="B Rank"></Filter></button>
</div>

<style>
    #battlesuits {
        display: grid;
        grid-template-columns: 100px repeat(auto-fill, 100px) 110px;
        grid-gap: 30px;
    }
</style>

<div class="mt-3" id="battlesuits">
    @foreach (var b in b)
    {
        <InfoCard Name="@b.Name" Image="@b.Image"></InfoCard>
    }
</div>

@code {
    List<Battlesuit>? b = new List<Battlesuit>();
    protected override async Task OnInitializedAsync() =>
        b = JsonConvert.DeserializeObject<List<Battlesuit>>(await BattlesuitService.GetAsync());

    private void FilterType()
    {
        b = b.Where(q => q.Type == "Mech").ToList();
    }

    private void FilterElement()
    {
        b = b.Where(q => q.Type == "Pyschic").ToList();
    }

    private void FilterRank()
    {
        b = b.Where(q => q.Id == 5).ToList();
    }
}
