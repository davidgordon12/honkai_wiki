@page "/weapons"
@using Newtonsoft.Json
@using honkai_wiki_api.Models
@using honkai_wiki.Services
@inject IWeaponService WeaponsService

<style>
    #filters {
        display: flex;
        flex-direction: row;
        flex-wrap: wrap;
    }

    .filter_btn {
        display: contents;
    }

    #weapons {
        display: grid;
        grid-template-columns: 100px repeat(auto-fill, 100px) 110px;
        grid-gap: 30px;
    }

    h2 {
        font-size: 45px;
    }
</style>

<h2 class="mt-3">Weapons</h2>
<h4 class="mt-3">Filter by Type:</h4>

<div id="filters">
    <button class="filter_btn" @onclick='(async () => await FilterType("Pistols"))'><Filter Icon="https://public-assets.abyss-lab.app/honkai3rd/type-icons/biologic.png" Type="Pistols"></Filter></button>
    <button class="filter_btn" @onclick='(async () => await FilterType("Katanas"))'><Filter Icon="https://public-assets.abyss-lab.app/honkai3rd/type-icons/psychic.png" Type="Katanas"></Filter></button>
    <button class="filter_btn" @onclick='(async () => await FilterType("Cannons"))'><Filter Icon="https://public-assets.abyss-lab.app/honkai3rd/type-icons/imaginary.png" Type="Cannons"></Filter></button>
    <button class="filter_btn" @onclick='(async () => await FilterType("Greatswords"))'><Filter Icon="https://public-assets.abyss-lab.app/honkai3rd/type-icons/quantum.png" Type="Greatswords"></Filter></button>
    <button class="filter_btn" @onclick='(async () => await FilterType("Crosses"))'><Filter Icon="https://public-assets.abyss-lab.app/honkai3rd/type-icons/quantum.png" Type="Crosses"></Filter></button>
    <button class="filter_btn" @onclick='(async () => await FilterType("Gauntlets"))'><Filter Icon="https://public-assets.abyss-lab.app/honkai3rd/type-icons/quantum.png" Type="Gauntlets"></Filter></button>
    <button class="filter_btn" @onclick='(async () => await FilterType("Scythes"))'><Filter Icon="https://public-assets.abyss-lab.app/honkai3rd/type-icons/quantum.png" Type="Scythes"></Filter></button>
    <button class="filter_btn" @onclick='(async () => await FilterType("Lances"))'><Filter Icon="https://public-assets.abyss-lab.app/honkai3rd/type-icons/quantum.png" Type="Lances"></Filter></button>
    <button class="filter_btn" @onclick='(async () => await FilterType("Bows"))'><Filter Icon="https://public-assets.abyss-lab.app/honkai3rd/type-icons/quantum.png" Type="Bows"></Filter></button>
    <button class="filter_btn" @onclick='(async () => await FilterType("Chakrams"))'><Filter Icon="https://public-assets.abyss-lab.app/honkai3rd/type-icons/quantum.png" Type="Chakrams"></Filter></button>
</div>

<div id="weapons">
    @foreach(var w in w)
    {
        <InfoCard Name="@w.Name" Image="@w.Image"></InfoCard>
    }
</div>

@code {
List<Weapon>? w = new List<Weapon>();
    protected override async Task OnInitializedAsync() =>
        w = JsonConvert.DeserializeObject<List<Weapon>>(await WeaponsService.GetAsync());

    private async Task FilterType(string filter) =>
        w = JsonConvert.DeserializeObject<List<Weapon>>(await WeaponsService.GetAsync()).Where(q => q.Type == filter).ToList();
}
